


Texture2D tex1 : register(t0);
Texture2D tex2 : register(t1);
Texture2D featuremap1 : register(t2);
Texture2D featuremap2 : register(t3);
//Texture2D tex3 : register(t4);
//Texture2D tex4 : register(t5);
SamplerState samp : register(s0);

cbuffer PS_CONSTANTS : register(b0)
{
    float4 size0;
    float inputPtY;
    float inputPtX;
    float2 fArgs;
    int4 iArgs;
    float2 int_argsf;
    int2 int_argsi;
};

struct PS_INPUT
{
    float4 Pos : SV_POSITION0;
    float2 Tex : TEXCOORD0;
    //float4 Pos1 : SV_POSITION1;
    //float2 Tex1 : TEXCOORD1;
};

struct PS_OUTPUT
{
    float4 target1 : SV_Target0;
    float4 target2 : SV_Target1;
};

PS_OUTPUT main(PS_INPUT input) : SV_Target
{
    PS_OUTPUT outp;
    // [tl, tc, tr]
	// [ml, mc, mr]
	// [bl, bc, br]
    float4 tl1 = tex1.Sample(samp, input.Tex + float2(-inputPtX, -inputPtY));
    float4 ml1 = tex1.Sample(samp, input.Tex + float2(-inputPtX, 0));
    float4 bl1 = tex1.Sample(samp, input.Tex + float2(-inputPtX, inputPtY));
    float4 tc1 = tex1.Sample(samp, input.Tex + float2(0, -inputPtY));
    float4 mc1 = tex1.Sample(samp, input.Tex);
    float4 bc1 = tex1.Sample(samp, input.Tex + float2(0, inputPtY));
    float4 tr1 = tex1.Sample(samp, input.Tex + float2(inputPtX, -inputPtY));
    float4 mr1 = tex1.Sample(samp, input.Tex + float2(inputPtX, 0));
    float4 br1 = tex1.Sample(samp, input.Tex + float2(inputPtX, inputPtY));

    float4 tl2 = tex2.Sample(samp, input.Tex + float2(-inputPtX, -inputPtY));
    float4 ml2 = tex2.Sample(samp, input.Tex + float2(-inputPtX, 0));
    float4 bl2 = tex2.Sample(samp, input.Tex + float2(-inputPtX, inputPtY));
    float4 tc2 = tex2.Sample(samp, input.Tex + float2(0, -inputPtY));
    float4 mc2 = tex2.Sample(samp, input.Tex);
    float4 bc2 = tex2.Sample(samp, input.Tex + float2(0, inputPtY));
    float4 tr2 = tex2.Sample(samp, input.Tex + float2(inputPtX, -inputPtY));
    float4 mr2 = tex2.Sample(samp, input.Tex + float2(inputPtX, 0));
    float4 br2 = tex2.Sample(samp, input.Tex + float2(inputPtX, inputPtY));

    float4 c1 = { -0.1306160986423492, -0.0808217376470566, -0.2880123555660248, 0.0099629526957870 };
    c1 += mul(tl1, float4x4(-0.1033539846539497, 0.0541300140321255, -0.0804840475320816, -0.0334571413695812, -0.0264753755182028, 0.1118840202689171, 0.1186013221740723, -0.0127575425431132, 0.2236593365669250, 0.0025286162272096, 0.0985530614852905, 0.0685181617736816, -0.1884875595569611, 0.0530862808227539, -0.0482063069939613, 0.0375233069062233));
    c1 += mul(tl2, float4x4(0.1837068796157837, -0.0632847175002098, 0.0016613919287920, 0.0392861217260361, 0.2923883199691772, -0.1713902205228806, 0.1907587945461273, 0.0550456829369068, 0.0644215345382690, -0.1046456992626190, 0.0187383033335209, 0.0770180150866508, 0.1933846622705460, -0.0455715768039227, 0.0375007353723049, -0.1053109914064407));
    c1 += mul(ml1, float4x4(-0.0972480997443199, 0.2820451855659485, 0.0114549007266760, -0.0954328626394272, 0.0706252008676529, 0.4829064607620239, -0.6371517181396484, 0.0005180989392102, 0.3280143439769745, 0.0665246024727821, -0.0503116399049759, -0.1261110603809357, 0.1114177703857422, -0.2053108513355255, 0.1428771317005157, 0.3926100134849548));
    c1 += mul(ml2, float4x4(-0.2571723163127899, 0.1627264618873596, -0.4940335154533386, -0.1361546218395233, 0.0804422944784164, -0.4231885373592377, 0.0650202706456184, 0.0518481098115444, -0.0502478554844856, -0.1305799931287766, 0.1814480125904083, 0.0090866927057505, -0.0510044656693935, -0.1691461503505707, 0.0922467112541199, -0.0314207412302494));
    c1 += mul(bl1, float4x4(0.1270498335361481, 0.0563284493982792, -0.0435525141656399, 0.1569847911596298, 0.0576847903430462, 0.3461692929267883, -0.0325655154883862, -0.2688976824283600, -0.1341977864503860, -0.1382253766059875, 0.2293784171342850, -0.1111817285418510, -0.1402447521686554, -0.3257531225681305, 0.0598510466516018, 0.1008039116859436));
    c1 += mul(bl2, float4x4(0.1698816716670990, 0.3491003513336182, -0.1367681026458740, -0.1165873408317566, -0.2091718912124634, -0.1487034261226654, -0.0569749698042870, -0.2100717276334763, 0.0404917001724243, -0.1372035890817642, 0.0689046755433083, -0.0367818064987659, -0.0325474888086319, -0.0114965448155999, -0.0137249026447535, -0.0279692262411118));
    c1 += mul(tc1, float4x4(-0.0563433989882469, 0.0132494345307350, -0.2434540390968323, 0.0796563774347305, -0.2109155058860779, 0.0387088693678379, -0.0591037571430206, 0.0955820381641388, 0.4660535752773285, -0.1204202473163605, 0.1332369595766068, -0.0285425651818514, -0.3886952698230743, -0.0434980578720570, -0.0849134400486946, 0.0802380964159966));
    c1 += mul(tc2, float4x4(0.0412235632538795, 0.1571959257125854, 0.2050069272518158, -0.1138664111495018, 0.1962715685367584, 0.0594439841806889, 0.0351715497672558, -0.0129811102524400, 0.2055217623710632, -0.0647534057497978, 0.0373471938073635, 0.0877277255058289, -0.5734645724296570, 0.1188675239682198, -0.1145943328738213, -0.1182733029127121));
    c1 += mul(mc1, float4x4(-0.2004909217357635, -0.4817073047161102, 0.5596802830696106, -0.0327854752540588, 0.0989314392209053, 0.4127818942070007, 0.7265836596488953, -0.2692042589187622, 0.5195841789245605, -0.2357539832592010, -0.3819393217563629, 0.1755530238151550, 0.6578183770179749, 0.1075539961457253, -0.2688144743442535, 0.3242723941802979));
    c1 += mul(mc2, float4x4(-0.3221310675144196, 0.2978510260581970, 0.2269985526800156, -0.3184116482734680, 0.4845580160617828, 0.4407236874103546, 0.0099756307899952, -0.3121858239173889, -0.3810067176818848, -0.0553649961948395, 0.0202834140509367, 0.0409953594207764, 0.2532750964164734, 0.2731618583202362, 0.1237529441714287, 0.0134243080392480));
    c1 += mul(bc1, float4x4(0.1835541725158691, 0.0549701862037182, -0.1749316602945328, -0.2030028849840164, 0.0263462308794260, 0.2781440317630768, 0.0372458845376968, 0.3643021881580353, -0.4047883749008179, 0.0660117194056511, 0.4863115549087524, -0.2024163603782654, -0.6403482556343079, 0.2765505611896515, 0.1417075097560883, 0.5064445734024048));
    c1 += mul(bc2, float4x4(0.6106975078582764, -0.1570862233638763, -0.3223383128643036, -0.2497926801443100, -0.4854303300380707, 0.0132978223264217, -0.0609334111213684, 0.1285556703805923, -0.1412864029407501, -0.1379042416810989, -0.0258826259523630, 0.1357705891132355, -0.1285902857780457, -0.0577826797962189, 0.0550044551491737, 0.1717510819435120));
    c1 += mul(tr1, float4x4(0.1389609426259995, 0.0835867226123810, 0.0309768319129944, -0.0278116948902607, -0.0390677824616432, -0.0111810686066747, -0.0025318188127130, 0.0069569633342326, 0.0347319357097149, 0.0191543344408274, 0.0314339138567448, -0.0228427499532700, 0.0416300334036350, 0.0249234102666378, 0.1210031509399414, 0.1142473593354225));
    c1 += mul(tr2, float4x4(0.0607251487672329, 0.0386395826935768, -0.0219341218471527, -0.1102298423647881, 0.1487188935279846, 0.0602982006967068, -0.0280748903751373, -0.0211924221366644, 0.0042894422076643, -0.0269144997000694, 0.0814756453037262, -0.0314031280577183, -0.0213186051696539, -0.1362965404987335, 0.0382767543196678, -0.0669511556625366));
    c1 += mul(mr1, float4x4(-0.2397561967372894, 0.3023172020912170, -0.2398054003715515, 0.0041919997893274, -0.1016605198383331, -0.1521034836769104, -0.1526568531990051, 0.0272433310747147, 0.0741761848330498, 0.1116370111703873, 0.1149727106094360, -0.0809784531593323, -0.1448147594928741, -0.0943927690386772, -0.0086280042305589, 0.1243222951889038));
    c1 += mul(mr2, float4x4(-0.0469366572797298, -0.1655988991260529, -0.1029584184288979, -0.1347874104976654, 0.2064601778984070, 0.0521226711571217, -0.1366733759641647, -0.0041872998699546, 0.1077186539769173, 0.0184442866593599, -0.2309073060750961, -0.1637075096368790, -0.0417953692376614, -0.3190860450267792, -0.1593534499406815, 0.0136412177234888));
    c1 += mul(br1, float4x4(0.1698798984289169, 0.0232755411416292, -0.0876034423708916, -0.3008348643779755, 0.0789884999394417, 0.0034748215693980, -0.0064704762771726, 0.0057828431017697, -0.0190630126744509, -0.0334153175354004, -0.0195646341890097, 0.0105131156742573, 0.0995147302746773, -0.3130289018154144, -0.0724022984504700, 0.0113303456455469));
    c1 += mul(br2, float4x4(-0.0027791252359748, -0.0193455871194601, -0.0415000133216381, 0.0568981170654297, -0.2745247483253479, 0.1222846284508705, 0.1899162530899048, 0.1067754998803139, -0.0561975166201591, -0.1500336527824402, 0.0526139959692955, -0.3491798937320709, -0.0692384615540504, -0.0307095069438219, 0.0498757846653461, 0.0019003645284101));
    c1 = max(c1, 0) + float4(0.1552927196025848, 0.0782765746116638, 0.7966942191123962, -1.1619627475738525) * min(c1, 0);

    float4 c2 = { -0.1443098634481430, -0.1343899369239807, -0.0624338127672672, -0.1094277128577232 };
    c2 += mul(tl1, float4x4(-0.0689977407455444, -0.1693786680698395, 0.0109281269833446, 0.0609922930598259, 0.0296908002346754, 0.1195700988173485, -0.0694077461957932, 0.0971287414431572, 0.0253518298268318, 0.1213042959570885, 0.0703809782862663, 0.0055739870294929, -0.1595942378044128, -0.1336689442396164, -0.0622441768646240, -0.0428023114800453));
    c2 += mul(tl2, float4x4(0.0860001668334007, -0.0226618759334087, 0.1602241247892380, 0.0431661494076252, 0.1526461094617844, 0.2752982378005981, 0.0960300788283348, -0.0536719262599945, -0.0171773489564657, 0.0457364916801453, -0.0360932648181915, -0.0397153608500957, -0.0277090407907963, 0.0729821547865868, -0.0145150292664766, 0.0252893269062042));
    c2 += mul(ml1, float4x4(-0.1407091915607452, -0.4007499516010284, -0.0302001200616360, -0.0606933943927288, -0.2960600554943085, -0.2263117432594299, 0.0721478462219238, -0.4578711986541748, 0.0960150733590126, -0.1606502830982208, 0.2444226741790771, 0.0000882153908606, 0.1472496986389160, 0.3256779909133911, -0.2132861614227295, 0.0339313484728336));
    c2 += mul(ml2, float4x4(-0.1477648764848709, -0.1487885862588882, -0.1973863691091537, 0.0717295333743095, 0.0843430235981941, 0.6259996294975281, -0.1214931011199951, -0.1274987608194351, 0.2359549105167389, 0.3002171218395233, -0.0825233608484268, -0.0157950688153505, 0.0706149637699127, 0.1762917637825012, -0.0611497573554516, -0.0859689489006996));
    c2 += mul(bl1, float4x4(0.0174895934760571, -0.0567042417824268, 0.0409146919846535, 0.0258173532783985, 0.1421577036380768, 0.1234543323516846, -0.1721662431955338, 0.1492216140031815, 0.1100751459598541, 0.0501539446413517, 0.1100447699427605, -0.1086079254746437, -0.0608497932553291, 0.0087817469611764, 0.0714464113116264, -0.1285197436809540));
    c2 += mul(bl2, float4x4(-0.0017177806003019, -0.1463395059108734, -0.1085453778505325, 0.1650195866823196, 0.0813829153776169, 0.1102061793208122, -0.0578421875834465, -0.0232036896049976, -0.1239888817071915, 0.0155465165153146, 0.1079114526510239, -0.0420837886631489, -0.0775837749242783, 0.0148941157385707, -0.0502299368381500, -0.0654754191637039));
    c2 += mul(tc1, float4x4(0.0918162539601326, 0.0440697595477104, -0.0515748932957649, 0.0417411290109158, 0.0353216230869293, 0.1535954177379608, 0.0439723692834377, -0.1288845241069794, 0.1076577678322792, -0.1306740194559097, 0.0715952813625336, -0.0681907683610916, -0.3798767924308777, 0.1023928597569466, -0.0970670804381371, 0.0077168666757643));
    c2 += mul(tc2, float4x4(0.0634560957551003, -0.0550306066870689, 0.2073986232280731, 0.0520241297781467, 0.1162287592887878, -0.2218665480613708, 0.3199682831764221, 0.0606246069073677, -0.0058511858806014, -0.0667045339941978, -0.0449917949736118, 0.0707788690924644, -0.3323366343975067, -0.0763893201947212, -0.0997853428125381, -0.1181001588702202));
    c2 += mul(mc1, float4x4(-0.3101258873939514, 0.2616009712219238, 0.0584651045501232, 0.1656491309404373, -0.0069236233830452, 0.2573371529579163, -0.1793291717767715, -0.2718756198883057, 0.0953581258654594, 0.0524105131626129, 0.1183085516095161, 0.0583294369280338, 0.5036848187446594, -0.5763167142868042, -0.2119628041982651, -0.3140562772750854));
    c2 += mul(mc2, float4x4(-0.2497755438089371, -0.0146329319104552, -0.2741575539112091, 0.2459975033998489, 0.3562706708908081, -0.6528629064559937, -0.4287456274032593, 0.2055913358926773, 0.1739019453525543, -0.3855968713760376, -0.0958273336291313, -0.7066691517829895, 0.2365748286247253, -0.3046728968620300, -0.2590373754501343, -0.0496727414429188));
    c2 += mul(bc1, float4x4(-0.0844531357288361, -0.0321611948311329, -0.0951840654015541, 0.0577518045902252, -0.1606003493070602, 0.2776086628437042, -0.1355003118515015, -0.0880064144730568, -0.1277643740177155, -0.0514567233622074, 0.1522682905197144, -0.1040910631418228, -0.2767944037914276, -0.1452194601297379, 0.0089118303731084, 0.0231996178627014));
    c2 += mul(bc2, float4x4(0.2603267133235931, 0.0167464651167393, -0.2064073234796524, 0.1782064288854599, 0.4890212416648865, 0.0559245310723782, 0.1221160590648651, -0.0202587731182575, -0.4056585729122162, -0.1839511841535568, 0.2775998413562775, 0.0024275144096464, -0.2624500989913940, -0.0619418807327747, 0.0153478365391493, 0.0123427547514439));
    c2 += mul(tr1, float4x4(0.0816635638475418, -0.0134946266189218, 0.0594766475260258, -0.0551253929734230, 0.0134431896731257, -0.0652195811271667, -0.0563635528087616, -0.0066532371565700, -0.0004114551993553, 0.0105680683627725, 0.1324467360973358, 0.0467248968780041, 0.0301312971860170, -0.1073397025465965, -0.0363437235355377, -0.0474153012037277));
    c2 += mul(tr2, float4x4(0.0199097190052271, 0.0901319086551666, 0.0448978282511234, 0.0505443066358566, 0.0438878424465656, -0.0494784042239189, 0.0724927335977554, -0.0070675504393876, -0.0012125011999160, 0.0295279901474714, 0.0705125033855438, 0.0555334389209747, -0.0403393507003784, -0.1271172016859055, 0.0017914215568453, 0.1462216079235077));
    c2 += mul(mr1, float4x4(-0.2827299833297729, 0.2052399665117264, 0.0042732120491564, -0.3969024717807770, -0.0782120972871780, 0.1960176974534988, -0.0675340741872787, 0.0027962317690253, 0.0516129024326801, -0.0352642722427845, 0.0546326488256454, 0.0065340655855834, -0.1062376946210861, 0.1364430636167526, -0.0536947809159756, 0.2098117172718048));
    c2 += mul(mr2, float4x4(0.0045875865034759, 0.2162927240133286, -0.2158576399087906, -0.0047327815555036, 0.1251590698957443, 0.1279677897691727, -0.1188964918255806, 0.0328494384884834, 0.0076038073748350, -0.0561547242105007, 0.0335608273744583, 0.4332321286201477, 0.0021786799188703, 0.0844521671533585, -0.2102309316396713, -0.0189208015799522));
    c2 += mul(br1, float4x4(0.0933093801140785, 0.1548244059085846, -0.0598701611161232, 0.0357220247387886, -0.1141726672649384, 0.0536412484943867, -0.0159156844019890, -0.0445508137345314, 0.1883231997489929, -0.1547038406133652, 0.0530619807541370, 0.0059371814131737, 0.0602529086172581, -0.0435577929019928, 0.0083390390500426, 0.0191930737346411));
    c2 += mul(br2, float4x4(-0.0351041629910469, 0.2119503468275070, -0.0841927304863930, 0.0079463515430689, 0.0683520361781120, -0.1657009869813919, 0.0611055232584476, -0.0063667562790215, 0.0330024957656860, -0.1810818463563919, 0.0872574150562286, 0.1485669612884521, -0.1305806934833527, 0.0041402997449040, 0.0223289318382740, -0.0141495745629072));
    c2 = max(c2, 0) + float4(0.5769761204719543, 0.1716064810752869, -0.0821026712656021, 0.2092144042253494) * min(c2, 0);

    outp.target1 = float4(0.0245648548007011, -0.4467784762382507, 0.0197526942938566, -0.0110000418499112);
    outp.target1 += mul(c1, float4x4(0.0302665308117867, -0.9262221455574036, -0.1161134764552116, -0.0506900474429131, 0.2716045379638672, -0.0485871583223343, 0.0044713355600834, -0.4274623394012451, 0.0749531090259552, -0.3700785338878632, 0.0350039415061474, -0.0540786534547806, -0.0607390031218529, -0.8019900321960449, 0.0923245251178741, 0.1258827745914459));
    outp.target1 += mul(c2, float4x4(-0.0649135261774063, 0.0815236791968346, 0.0067334296181798, 0.1277425885200500, -0.0051357815973461, -0.1485908329486847, 0.0074226572178304, 0.0050623500719666, 0.0588018335402012, -0.0692552924156189, 0.1288725286722183, -0.0989386290311813, 0.0427936837077141, 0.0967708528041840, -0.0455632135272026, -0.0711275041103363));
    outp.target1 += featuremap1.Sample(samp, input.Tex);
    outp.target1 = max(outp.target1, 0) + float4(0.9927186965942383, 0.0570580027997494, 1.3226752281188965, 1.0069466829299927) * min(outp.target1, 0);

    outp.target2 = float4(-0.0425243787467480, -0.3715015351772308, -0.0256227850914001, -0.2774516046047211);
    outp.target2 += mul(c1, float4x4(0.0238118842244148, 0.0295480657368898, -0.0066418983042240, 0.1021223962306976, -0.0568209178745747, -0.4355100393295288, -0.2700522541999817, -0.2060186564922333, -0.0689613372087479, -0.1689691990613937, -0.0306748505681753, -0.2461252212524414, -0.0057375836186111, -0.1892303228378296, -0.0285871494561434, -0.5032613277435303));
    outp.target2 += mul(c2, float4x4(0.5463213324546814, 0.0972800329327583, 0.0307560767978430, 0.0678058937191963, -0.0356063023209572, -0.7013865113258362, 0.1890443563461304, -0.1036657467484474, -0.1745826154947281, -0.2942218780517578, -0.0485423319041729, -0.2983124554157257, -0.0524431839585304, -0.3261034786701202, 0.3217246532440186, 0.1958018541336060));
    outp.target2 += featuremap2.Sample(samp, input.Tex);
    outp.target2 = max(outp.target2, 0) + float4(0.1391339898109436, 0.0960328355431557, 0.6235341429710388, 0.1177272796630859) * min(outp.target2, 0);
    return outp;
}